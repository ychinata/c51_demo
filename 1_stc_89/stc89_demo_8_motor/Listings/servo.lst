C51 COMPILER V9.54   SERVO                                                                 06/24/2023 11:59:34 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE SERVO
OBJECT MODULE PLACED IN .\Objects\servo.obj
COMPILER INVOKED BY: D:\Software\Keil\Keil_C51\C51\BIN\C51.EXE servo.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT
                    -(.\Listings\servo.lst) OBJECT(.\Objects\servo.obj)

line level    source

   1          //#include "reg52.h"                    //         头文件
   2          #include <REGX52.H>
   3          #include "delay.h"
   4          #include "servo.h"
   5          
   6          sbit Sevro_moto_pwm = P3^7;             // 舵机信号线（橙色）
   7          
   8          unsigned char pwm_val  = 0;//变量定义
   9          unsigned char push_val = 14;//舵机归中，产生约，1.5MS 信号
  10                                          
  11          
  12          //void delay1ms(unsigned int k)   //延时1ms函数，k等于多少就延时多少ms
  13          //{
  14          //    unsigned int a,b,c,d;
  15          //      for(d=0;d<k;d++)
  16          //        for(c=1;c>0;c--)
  17          //            for(b=50;b>0;b--)
  18          //                for(a=2;a>0;a--);
  19          //}                                                                
  20          
  21          
  22          /**********************************************************************************************
  23          **                              TIMER1中断服务子函数产生PWM信号
  24          **********************************************************************************************/
  25          //void time1()interrupt 3 using 2 // using可以不用
  26          //{     
  27          //    TH1=(65536-100)/256;        //100US定时
  28          //    TL1=(65536-100)%256;
  29          //    pwm_val++;
  30          //    
  31          //    if(pwm_val<=push_val)       
  32          //        Sevro_moto_pwm=1;   //PWM信号高电平时间
  33          //    else 
  34          //        Sevro_moto_pwm=0;   //PWM信号高电平时间
  35          //    if(pwm_val>=100)
  36          //        pwm_val=0;
  37          //}
  38          
  39          // 定时器0初始化
  40          void Timer0_Init() 
  41          {
  42   1              TMOD=0X10;
  43   1              TH1=(65536-100)/256;      //100US定时
  44   1              TL1=(65536-100)%256;
  45   1              TR1= 1;
  46   1              ET1= 1;
  47   1              EA = 1;
  48   1      }
  49          
  50          // 90度舵机
  51          void SERVO_Init() 
  52          {
  53   1          push_val=13;          //舵机归中，机器执行指令有周期，所以PWM信号有误差
  54   1              DELAY_ms(1000);   //延时1S让舵机转到其位置，停留一下
C51 COMPILER V9.54   SERVO                                                                 06/24/2023 11:59:34 PAGE 2   

  55   1      }
  56          
  57          // 90度舵机
  58          void SERVO_Set90DegPlus()
  59          {
  60   1          push_val=4;   //舵机向正转约90度，机器执行指令有周期，所以PWM信号有误差
  61   1      }
  62          
  63          // 90度舵机
  64          void SERVO_Set90DegMinus()
  65          {
  66   1          push_val=22;          //舵机向反转约90度，机器执行指令有周期，所以PWM信号有误差
  67   1      }
  68                  
  69          
  70          /**********************************************************************************************
  71          **                                       主函数
  72          **********************************************************************************************/
  73          void SERVO_Task(void)
  74          {
  75   1          SERVO_Set90DegPlus();
  76   1          DELAY_ms(2000); //延时500MS让舵机转到其位置
  77   1      
  78   1          SERVO_Set90DegMinus();
  79   1          DELAY_ms(2000); //延时500MS让舵机转到其位置
  80   1      }   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     54    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
